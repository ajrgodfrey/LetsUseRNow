<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>11 LURN... To Do Basic Inference</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html,2,next --> 
<meta name="src" content="LURN.tex"> 
<link rel="stylesheet" type="text/css" href="LURN.css"> 
</head><body 
>
   <!--l. 7--><div class="crosslinks"><p class="noindent">[<a 
href="../LURNblind/LURNBlindch11.html">Version for blind users</a>] [<a 

href="LURNch12.html" >next</a>] [<a 
href="LURNch10.html" >prev</a>] [<a 
href="LURNch10.html#tailLURNch10.html" >prev-tail</a>] [<a 
href="#tailLURNch11.html">tail</a>] [<a 
href="LURN.html#LURNch11.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;11</span><br /><a 
 id="x13-7900011"></a>LURN&#x2026; To Do Basic Inference</h2>
<!--l. 16--><p class="noindent" >This chapter is all about finding confidence intervals and performing hypothesis
tests. While many textbooks separate these activities there is little point doing so
when it comes time to using <span 
class="aess-12">R </span>as both are done at the same time in the majority
of cases.
   <h3 class="sectionHead"><span class="titlemark">11.1   </span> <a 
 id="x13-8000011.1"></a>Confidence intervals and hypothesis tests for the mean of one
population</h3>
<!--l. 21--><p class="noindent" >The <a 
 id="dx13-80001"></a><span 
class="aeti-12">datasets </span>package contains a set of annual precipitation values (in inches) for
70 U.S. cities. If we could assume this set to be a random sample (and we will
even if it is not true), then we can find a confidence interval for the mean annual
precipitation for U.S. cities on the whole.
<!--l. 23--><p class="indent" >   You could use a manual approach to find the 95% confidence interval for the
population mean (<span 
class="cmmi-12">&#x03BC;</span>) yourself using the <a 
 id="dx13-80002"></a><span 
class="aett-12">mean()</span>, <a 
 id="dx13-80003"></a><span 
class="aett-12">sd()</span>, <a 
 id="dx13-80004"></a><span 
class="aett-12">length()</span>, and <a 
 id="dx13-80005"></a><span 
class="aett-12">qt()</span>
commands as follows:
<!--l. 27--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb234">  <a 
 id="x13-80007r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;mean(precip)</span></div>
<!--l. 30--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb235"> <a 
 id="x13-80009r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;34.89</span></div>
<!--l. 33--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb236"> <a 
 id="x13-80011r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;sd(precip)</span></div>
<!--l. 36--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb237"> <a 
 id="x13-80013r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;13.71</span></div>
<!--l. 39--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb238"> <a 
 id="x13-80015r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;length(precip)</span></div>
<!--l. 42--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb239"> <a 
 id="x13-80017r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;70</span></div>
<!--l. 45--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb240"> <a 
 id="x13-80019r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;qt(0.975,</span><span 
class="aett-12">&#x00A0;length(precip)-1)</span></div>
                                                                          

                                                                          
<!--l. 48--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb241"> <a 
 id="x13-80021r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;1.995</span></div>
<!--l. 54--><p class="indent" >   Note the use of the <a 
 id="dx13-80022"></a><span 
class="aett-12">qt() </span>command here. It has two arguments; one for the
level of confidence (95% confidence relates to an upper tail area of 0.025) and the
degrees of freedom (based on the sample size). The 95% confidence interval is
therefore found using
<!--l. 58--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb242">  <a 
 id="x13-80024r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;mean(precip)</span><span 
class="aett-12">&#x00A0;-</span><span 
class="aett-12">&#x00A0;qt(0.975,</span><span 
class="aett-12">&#x00A0;length(precip)-1)</span><span 
class="aett-12">&#x00A0;*</span><span 
class="aett-12">&#x00A0;sd(precip)</span><span 
class="aett-12">&#x00A0;/</span><span 
class="aett-12">&#x00A0;sqrt(length(precip))</span></div>
<!--l. 61--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb243"> <a 
 id="x13-80026r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;31.62</span></div>
<!--l. 64--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb244"> <a 
 id="x13-80028r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;mean(precip)</span><span 
class="aett-12">&#x00A0;+</span><span 
class="aett-12">&#x00A0;qt(0.975,</span><span 
class="aett-12">&#x00A0;length(precip)-1)</span><span 
class="aett-12">&#x00A0;*</span><span 
class="aett-12">&#x00A0;sd(precip)</span><span 
class="aett-12">&#x00A0;/</span><span 
class="aett-12">&#x00A0;sqrt(length(precip))</span></div>
<!--l. 67--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb245"> <a 
 id="x13-80030r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;38.15</span></div>
<!--l. 73--><p class="indent" >   or, with a nicer (quicker) command:
<!--l. 77--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb246">  <a 
 id="x13-80032r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;mean(precip)</span><span 
class="aett-12">&#x00A0;+</span><span 
class="aett-12">&#x00A0;c(-1,1)</span><span 
class="aett-12">&#x00A0;*</span><span 
class="aett-12">&#x00A0;qt(0.975,</span><span 
class="aett-12">&#x00A0;length(precip)-1)</span><span 
class="aett-12">&#x00A0;*</span><span 
class="aett-12">&#x00A0;sd(precip)</span><span 
class="aett-12">&#x00A0;/</span><span 
class="aett-12">&#x00A0;sqrt(length(precip))</span></div>
<!--l. 80--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb247"> <a 
 id="x13-80034r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;31.62</span><span 
class="aett-12">&#x00A0;38.15</span></div>
<!--l. 86--><p class="indent" >   These calculations include all the commands needed for a hypothesis test,
except the need to find the specific <span 
class="cmmi-12">p</span>-value of a hypothesis test. Let&#8217;s test the
notion that the annual precipitation is actually greater than 30 inches per
annum. This is a one-sided hypothesis test where the null hypothesis is that
<span 
class="cmmi-12">&#x03BC; </span><span 
class="cmr-12">= 30</span>.
<!--l. 90--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb248">  <a 
 id="x13-80036r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;TestStat=</span><span 
class="aett-12">&#x00A0;(mean(precip)-30)/(sd(precip)</span><span 
class="aett-12">&#x00A0;/</span><span 
class="aett-12">&#x00A0;sqrt(length(precip)))</span>
<br class="fancyvrb" /><a 
 id="x13-80038r2"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;pt(TestStat,</span><span 
class="aett-12">&#x00A0;length(precip)-1,</span><span 
class="aett-12">&#x00A0;lower.tail=FALSE)</span></div>
<!--l. 94--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb249"> <a 
 id="x13-80040r1"></a><span 
class="aett-12">[1]</span><span 
class="aett-12">&#x00A0;0.001976</span></div>
                                                                          

                                                                          
<!--l. 100--><p class="indent" >   Note that the <a 
 id="dx13-80041"></a><span 
class="aett-12">pt() </span>command required us to think about the degrees of
freedom and that the upper tail area was important to us. We now see that the
null hypothesis is rejected as the <span 
class="cmmi-12">p</span>-value is very small.
<!--l. 102--><p class="indent" >   These calculations are fine, but there is a quicker way! The <a 
 id="dx13-80042"></a><span 
class="aett-12">t.test()</span>
command does it all for us &#8212; both confidence interval and hypothesis
test.
<!--l. 106--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb250">  <a 
 id="x13-80044r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;t.test(precip)</span></div>
<!--l. 109--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb251"> <a 
 id="x13-80046r1"></a><br class="fancyvrb" /><a 
 id="x13-80048r2"></a>        <span 
class="aett-12">One</span><span 
class="aett-12">&#x00A0;Sample</span><span 
class="aett-12">&#x00A0;t-test</span><br class="fancyvrb" /><a 
 id="x13-80050r3"></a><br class="fancyvrb" /><a 
 id="x13-80052r4"></a><span 
class="aett-12">data:</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;precip</span><br class="fancyvrb" /><a 
 id="x13-80054r5"></a><span 
class="aett-12">t</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;21,</span><span 
class="aett-12">&#x00A0;df</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;69,</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;&#x003C;2e-16</span>
<br class="fancyvrb" /><a 
 id="x13-80056r6"></a><span 
class="aett-12">alternative</span><span 
class="aett-12">&#x00A0;hypothesis:</span><span 
class="aett-12">&#x00A0;true</span><span 
class="aett-12">&#x00A0;mean</span><span 
class="aett-12">&#x00A0;is</span><span 
class="aett-12">&#x00A0;not</span><span 
class="aett-12">&#x00A0;equal</span><span 
class="aett-12">&#x00A0;to</span><span 
class="aett-12">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x13-80058r7"></a><span 
class="aett-12">95</span><span 
class="aett-12">&#x00A0;percent</span><span 
class="aett-12">&#x00A0;confidence</span><span 
class="aett-12">&#x00A0;interval:</span><br class="fancyvrb" /><a 
 id="x13-80060r8"></a><span 
class="aett-12">&#x00A0;31.62</span><span 
class="aett-12">&#x00A0;38.15</span><br class="fancyvrb" /><a 
 id="x13-80062r9"></a><span 
class="aett-12">sample</span><span 
class="aett-12">&#x00A0;estimates:</span><br class="fancyvrb" /><a 
 id="x13-80064r10"></a><span 
class="aett-12">mean</span><span 
class="aett-12">&#x00A0;of</span><span 
class="aett-12">&#x00A0;x</span><br class="fancyvrb" /><a 
 id="x13-80066r11"></a><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;34.89</span></div>
<!--l. 125--><p class="indent" >   This gives a confidence interval with the default level of confidence (95%),
while
<!--l. 129--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb252">  <a 
 id="x13-80068r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;t.test(precip,</span><span 
class="aett-12">&#x00A0;mu=30,</span><span 
class="aett-12">&#x00A0;alternative="greater")</span></div>
<!--l. 132--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb253"> <a 
 id="x13-80070r1"></a><br class="fancyvrb" /><a 
 id="x13-80072r2"></a>        <span 
class="aett-12">One</span><span 
class="aett-12">&#x00A0;Sample</span><span 
class="aett-12">&#x00A0;t-test</span><br class="fancyvrb" /><a 
 id="x13-80074r3"></a><br class="fancyvrb" /><a 
 id="x13-80076r4"></a><span 
class="aett-12">data:</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;precip</span><br class="fancyvrb" /><a 
 id="x13-80078r5"></a><span 
class="aett-12">t</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;3,</span><span 
class="aett-12">&#x00A0;df</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;69,</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;0.002</span>
<br class="fancyvrb" /><a 
 id="x13-80080r6"></a><span 
class="aett-12">alternative</span><span 
class="aett-12">&#x00A0;hypothesis:</span><span 
class="aett-12">&#x00A0;true</span><span 
class="aett-12">&#x00A0;mean</span><span 
class="aett-12">&#x00A0;is</span><span 
class="aett-12">&#x00A0;greater</span><span 
class="aett-12">&#x00A0;than</span><span 
class="aett-12">&#x00A0;30</span>
<br class="fancyvrb" /><a 
 id="x13-80082r7"></a><span 
class="aett-12">95</span><span 
class="aett-12">&#x00A0;percent</span><span 
class="aett-12">&#x00A0;confidence</span><span 
class="aett-12">&#x00A0;interval:</span><br class="fancyvrb" /><a 
 id="x13-80084r8"></a><span 
class="aett-12">&#x00A0;32.15</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;Inf</span><br class="fancyvrb" /><a 
 id="x13-80086r9"></a><span 
class="aett-12">sample</span><span 
class="aett-12">&#x00A0;estimates:</span><br class="fancyvrb" /><a 
 id="x13-80088r10"></a><span 
class="aett-12">mean</span><span 
class="aett-12">&#x00A0;of</span><span 
class="aett-12">&#x00A0;x</span><br class="fancyvrb" /><a 
 id="x13-80090r11"></a><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;34.89</span></div>
<!--l. 148--><p class="indent" >   gives us the results for a one-sided hypothesis test and the corresponding
confidence interval.
<!--l. 150--><p class="indent" >   The <a 
 id="dx13-80091"></a><span 
class="aett-12">t.test() </span>command is used for many <span 
class="cmmi-12">t</span>-tests, notably for comparing two
population means, whether the data are paired or not.
<!--l. 152--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">11.2   </span> <a 
 id="x13-8100011.2"></a>Confidence intervals and hypothesis tests for the difference of two
population means</h3>
<!--l. 154--><p class="noindent" >The first question you must ask yourself when working with two sets of
values you wish to compare is if they are two independent samples or
two measurements taken on one sample. If the latter is the case, then
we have paired samples and will need to add an extra argument to our
command to allow for the link. In both cases, the difference of the two
population means is denoted <span 
class="cmmi-12">&#x03BC;</span><sub><span 
class="cmr-8">1</span></sub> <span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">&#x03BC;</span><sub><span 
class="cmr-8">2</span></sub>, although as we will see, the linked
sample case is really a reduction of the paired values to a one-sample
<span 
class="cmmi-12">t</span>-test.
                                                                          

                                                                          
<!--l. 156--><p class="indent" >   First, we see how to do a basic two sample <span 
class="cmmi-12">t</span>-test using the ... data.
<!--l. 160--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">11.2.1   </span> <a 
 id="x13-8200011.2.1"></a>Two paired samples</h4>
<!--l. 163--><p class="noindent" >The <span 
class="aett-12">sleep </span>data that is in the <a 
 id="dx13-82001"></a><span 
class="aeti-12">datasets </span>package has two recordings for each of
ten individuals. In an experimental design sense, we would think of the
individuals as a blocking factor. In fact we will see how this is done in
Section&#x00A0;<a 
href="LURNch13.html#x15-10200013.4.1">13.4.1<!--tex4ht:ref: RCBAnalysis --></a>.
<!--l. 165--><p class="indent" >   The data set lists the twenty observations in a single column. This is a
little unusual for paired data that will be analyzed using the <a 
 id="dx13-82002"></a><span 
class="aett-12">t.test()</span>
command. Caution must be expressed because the variable that shows
how the observations are paired is not stated. If the observations are not
ordered the same for each group, then the paring will be done incorrectly.
If for any reason you cannot be sure of the ordering of the data then
the use of the <a 
 id="dx13-82003"></a><span 
class="aett-12">aov() </span>command as discussed in Section&#x00A0;<a 
href="LURNch13.html#x15-10200013.4.1">13.4.1<!--tex4ht:ref: RCBAnalysis --></a> is strongly
advised.
<!--l. 167--><p class="indent" >   Using the <a 
 id="dx13-82004"></a><span 
class="aett-12">attach() </span>command to be able to refer to the variables directly
speeds up this process.
<!--l. 171--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb254">  <a 
 id="x13-82006r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;attach(sleep)</span></div>
<!--l. 178--><p class="indent" >   We employ the <a 
 id="dx13-82007"></a><span 
class="aett-12">t.test() </span>command with the <span 
class="aett-12">paired </span>argument set to <span 
class="aett-12">TRUE</span>.
We can use either of two approaches. Either we separate the two groups apart
using subscripting
<!--l. 182--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb255">  <a 
 id="x13-82009r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;t.test(extra[group=="1"],</span><span 
class="aett-12">&#x00A0;extra[group=="2"],</span><span 
class="aett-12">&#x00A0;paired=TRUE)</span></div>
<!--l. 185--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb256"> <a 
 id="x13-82011r1"></a><br class="fancyvrb" /><a 
 id="x13-82013r2"></a>        <span 
class="aett-12">Paired</span><span 
class="aett-12">&#x00A0;t-test</span><br class="fancyvrb" /><a 
 id="x13-82015r3"></a><br class="fancyvrb" /><a 
 id="x13-82017r4"></a><span 
class="aett-12">data:</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;extra[group</span><span 
class="aett-12">&#x00A0;==</span><span 
class="aett-12">&#x00A0;"1"]</span><span 
class="aett-12">&#x00A0;and</span><span 
class="aett-12">&#x00A0;extra[group</span><span 
class="aett-12">&#x00A0;==</span><span 
class="aett-12">&#x00A0;"2"]</span>
<br class="fancyvrb" /><a 
 id="x13-82019r5"></a><span 
class="aett-12">t</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;-4.1,</span><span 
class="aett-12">&#x00A0;df</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;9,</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;0.003</span>
<br class="fancyvrb" /><a 
 id="x13-82021r6"></a><span 
class="aett-12">alternative</span><span 
class="aett-12">&#x00A0;hypothesis:</span><span 
class="aett-12">&#x00A0;true</span><span 
class="aett-12">&#x00A0;difference</span><span 
class="aett-12">&#x00A0;in</span><span 
class="aett-12">&#x00A0;means</span><span 
class="aett-12">&#x00A0;is</span><span 
class="aett-12">&#x00A0;not</span><span 
class="aett-12">&#x00A0;equal</span><span 
class="aett-12">&#x00A0;to</span><span 
class="aett-12">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x13-82023r7"></a><span 
class="aett-12">95</span><span 
class="aett-12">&#x00A0;percent</span><span 
class="aett-12">&#x00A0;confidence</span><span 
class="aett-12">&#x00A0;interval:</span><br class="fancyvrb" /><a 
 id="x13-82025r8"></a><span 
class="aett-12">&#x00A0;-2.4599</span><span 
class="aett-12">&#x00A0;-0.7001</span><br class="fancyvrb" /><a 
 id="x13-82027r9"></a><span 
class="aett-12">sample</span><span 
class="aett-12">&#x00A0;estimates:</span>
<br class="fancyvrb" /><a 
 id="x13-82029r10"></a><span 
class="aett-12">mean</span><span 
class="aett-12">&#x00A0;of</span><span 
class="aett-12">&#x00A0;the</span><span 
class="aett-12">&#x00A0;differences</span><br class="fancyvrb" /><a 
 id="x13-82031r11"></a><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;-1.58</span></div>
<!--l. 202--><p class="indent" >   which is the way we would normally work when we have the two measurements
stored using two distinct variables; or, use the formula approach:
<!--l. 206--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb257">  <a 
 id="x13-82033r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;t.test(extra~group,</span><span 
class="aett-12">&#x00A0;paired=TRUE)</span></div>
                                                                          

                                                                          
<!--l. 209--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb258"> <a 
 id="x13-82035r1"></a><br class="fancyvrb" /><a 
 id="x13-82037r2"></a>        <span 
class="aett-12">Paired</span><span 
class="aett-12">&#x00A0;t-test</span><br class="fancyvrb" /><a 
 id="x13-82039r3"></a><br class="fancyvrb" /><a 
 id="x13-82041r4"></a><span 
class="aett-12">data:</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;extra</span><span 
class="aett-12">&#x00A0;by</span><span 
class="aett-12">&#x00A0;group</span><br class="fancyvrb" /><a 
 id="x13-82043r5"></a><span 
class="aett-12">t</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;-4.1,</span><span 
class="aett-12">&#x00A0;df</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;9,</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;0.003</span>
<br class="fancyvrb" /><a 
 id="x13-82045r6"></a><span 
class="aett-12">alternative</span><span 
class="aett-12">&#x00A0;hypothesis:</span><span 
class="aett-12">&#x00A0;true</span><span 
class="aett-12">&#x00A0;difference</span><span 
class="aett-12">&#x00A0;in</span><span 
class="aett-12">&#x00A0;means</span><span 
class="aett-12">&#x00A0;is</span><span 
class="aett-12">&#x00A0;not</span><span 
class="aett-12">&#x00A0;equal</span><span 
class="aett-12">&#x00A0;to</span><span 
class="aett-12">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x13-82047r7"></a><span 
class="aett-12">95</span><span 
class="aett-12">&#x00A0;percent</span><span 
class="aett-12">&#x00A0;confidence</span><span 
class="aett-12">&#x00A0;interval:</span><br class="fancyvrb" /><a 
 id="x13-82049r8"></a><span 
class="aett-12">&#x00A0;-2.4599</span><span 
class="aett-12">&#x00A0;-0.7001</span><br class="fancyvrb" /><a 
 id="x13-82051r9"></a><span 
class="aett-12">sample</span><span 
class="aett-12">&#x00A0;estimates:</span>
<br class="fancyvrb" /><a 
 id="x13-82053r10"></a><span 
class="aett-12">mean</span><span 
class="aett-12">&#x00A0;of</span><span 
class="aett-12">&#x00A0;the</span><span 
class="aett-12">&#x00A0;differences</span><br class="fancyvrb" /><a 
 id="x13-82055r11"></a><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;-1.58</span></div>
<!--l. 226--><p class="indent" >   You could of course alter the analysis by adding arguments to these commands
to suit your needs. Experiment a little before detaching the <span 
class="aett-12">sleep </span>data using the
<a 
 id="dx13-82056"></a><span 
class="aett-12">detach() </span>command:
<!--l. 230--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb259">  <a 
 id="x13-82058r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;detach(sleep)</span></div>
<!--l. 238--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">11.3   </span> <a 
 id="x13-8300011.3"></a>Confidence intervals and hypothesis tests for a proportion from one
population</h3>
<!--l. 241--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">11.4   </span> <a 
 id="x13-8400011.4"></a>Confidence intervals and hypothesis tests for the difference of two
population proportions</h3>
<!--l. 244--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">11.5   </span> <a 
 id="x13-8500011.5"></a>Hypothesis tests and confidence intervals for Correlation coefficients</h3>
<!--l. 246--><p class="noindent" >In Section&#x00A0;<a 
href="LURNch8.html#x10-630008.4">8.4<!--tex4ht:ref: CorrelationStructure --></a> we examined the correlation of the variables in the <span 
class="aett-12">airquality</span>
data set using the <a 
 id="dx13-85001"></a><span 
class="aett-12">cor() </span>command. If we require a formal hypothesis
test for the significance of the correlation coefficient we will need to use
the <a 
 id="dx13-85002"></a><span 
class="aett-12">cor.test() </span>command. The difference between the two commands is
that we could offer the entire data set as the object to work on with the
<a 
 id="dx13-85003"></a><span 
class="aett-12">cor() </span>command while we need to specify two vectors for the <a 
 id="dx13-85004"></a><span 
class="aett-12">cor.test()</span>
command.
<!--l. 250--><p class="indent" >   There are problems with cherry-picking one pair of variables from a set to
perform a post hoc test like this. We should probably consider finding the
significance of all correlations of interest and adjusting the way we think about
the likelihood of getting the set of hypothesis tests we observe as a combination
using a <a 
 id="dx13-85005"></a><span 
class="aeti-12">Bonn Ferroni adjustment </span>in our analysis; that is beyond the scope of this
                                                                          

                                                                          
exposition so for the moment just assume we are (and were before data was
collected) interested in only the correlation that exists between a single pair of
variables. We use the <span 
class="aett-12">Ozone </span>and <span 
class="aett-12">Wind </span>variables from the <span 
class="aett-12">airquality</span>
data.
<!--l. 252--><p class="indent" >   To test the notion that there is zero correlation between the two variables we
would probably consider using Pearson&#8217;s correlation coefficient which measures
the strength of the linear relationship between a pair of variables, but use of
Spearman&#8217;s rank correlation coefficient will measure the strength of any
monotonic relationship that might exist. I prefer to use both at the same time in
many circumstances.
<!--l. 256--><p class="indent" >
   <div class="fancyvrb" id="fancyvrb260">  <a 
 id="x13-85007r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;attach(airquality)</span><br class="fancyvrb" /><a 
 id="x13-85009r2"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;cor.test(Ozone,</span><span 
class="aett-12">&#x00A0;Wind)</span></div>
<!--l. 260--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb261"> <a 
 id="x13-85011r1"></a><br class="fancyvrb" /><a 
 id="x13-85013r2"></a>        <span 
class="aett-12">Pearson</span><span 
class="tctt-1200">'</span><span 
class="aett-12">s</span><span 
class="aett-12">&#x00A0;product-moment</span><span 
class="aett-12">&#x00A0;correlation</span><br class="fancyvrb" /><a 
 id="x13-85015r3"></a>
<br class="fancyvrb" /><a 
 id="x13-85017r4"></a><span 
class="aett-12">data:</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;Ozone</span><span 
class="aett-12">&#x00A0;and</span><span 
class="aett-12">&#x00A0;Wind</span><br class="fancyvrb" /><a 
 id="x13-85019r5"></a><span 
class="aett-12">t</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;-8,</span><span 
class="aett-12">&#x00A0;df</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;110,</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;9e-13</span>
<br class="fancyvrb" /><a 
 id="x13-85021r6"></a><span 
class="aett-12">alternative</span><span 
class="aett-12">&#x00A0;hypothesis:</span><span 
class="aett-12">&#x00A0;true</span><span 
class="aett-12">&#x00A0;correlation</span><span 
class="aett-12">&#x00A0;is</span><span 
class="aett-12">&#x00A0;not</span><span 
class="aett-12">&#x00A0;equal</span><span 
class="aett-12">&#x00A0;to</span><span 
class="aett-12">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x13-85023r7"></a><span 
class="aett-12">95</span><span 
class="aett-12">&#x00A0;percent</span><span 
class="aett-12">&#x00A0;confidence</span><span 
class="aett-12">&#x00A0;interval:</span><br class="fancyvrb" /><a 
 id="x13-85025r8"></a><span 
class="aett-12">&#x00A0;-0.7064</span><span 
class="aett-12">&#x00A0;-0.4709</span><br class="fancyvrb" /><a 
 id="x13-85027r9"></a><span 
class="aett-12">sample</span><span 
class="aett-12">&#x00A0;estimates:</span><br class="fancyvrb" /><a 
 id="x13-85029r10"></a><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;cor</span><br class="fancyvrb" /><a 
 id="x13-85031r11"></a><span 
class="aett-12">-0.6015</span></div>
<!--l. 273--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb262"> <a 
 id="x13-85033r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;cor.test(Ozone,</span><span 
class="aett-12">&#x00A0;Wind,</span><span 
class="aett-12">&#x00A0;method="spearman")</span></div>
<!--l. 276--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb263"> <a 
 id="x13-85035r1"></a><span 
class="aett-12">Warning</span><span 
class="aett-12">&#x00A0;in</span><span 
class="aett-12">&#x00A0;cor.test.default(Ozone,</span><span 
class="aett-12">&#x00A0;Wind,</span><span 
class="aett-12">&#x00A0;method</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;"spearman"):</span><span 
class="aett-12">&#x00A0;Cannot</span><span 
class="aett-12">&#x00A0;compute</span><span 
class="aett-12">&#x00A0;exact</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;with</span><span 
class="aett-12">&#x00A0;ties</span></div>
<!--l. 279--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb264"> <a 
 id="x13-85037r1"></a><br class="fancyvrb" /><a 
 id="x13-85039r2"></a>        <span 
class="aett-12">Spearman</span><span 
class="tctt-1200">'</span><span 
class="aett-12">s</span><span 
class="aett-12">&#x00A0;rank</span><span 
class="aett-12">&#x00A0;correlation</span><span 
class="aett-12">&#x00A0;rho</span><br class="fancyvrb" /><a 
 id="x13-85041r3"></a><br class="fancyvrb" /><a 
 id="x13-85043r4"></a><span 
class="aett-12">data:</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;Ozone</span><span 
class="aett-12">&#x00A0;and</span><span 
class="aett-12">&#x00A0;Wind</span>
<br class="fancyvrb" /><a 
 id="x13-85045r5"></a><span 
class="aett-12">S</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;410000,</span><span 
class="aett-12">&#x00A0;p-value</span><span 
class="aett-12">&#x00A0;=</span><span 
class="aett-12">&#x00A0;3e-12</span><br class="fancyvrb" /><a 
 id="x13-85047r6"></a><span 
class="aett-12">alternative</span><span 
class="aett-12">&#x00A0;hypothesis:</span><span 
class="aett-12">&#x00A0;true</span><span 
class="aett-12">&#x00A0;rho</span><span 
class="aett-12">&#x00A0;is</span><span 
class="aett-12">&#x00A0;not</span><span 
class="aett-12">&#x00A0;equal</span><span 
class="aett-12">&#x00A0;to</span><span 
class="aett-12">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x13-85049r7"></a><span 
class="aett-12">sample</span><span 
class="aett-12">&#x00A0;estimates:</span><br class="fancyvrb" /><a 
 id="x13-85051r8"></a><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;</span><span 
class="aett-12">&#x00A0;rho</span><br class="fancyvrb" /><a 
 id="x13-85053r9"></a><span 
class="aett-12">-0.5902</span></div>
<!--l. 290--><p class="noindent" >
   <div class="fancyvrb" id="fancyvrb265"> <a 
 id="x13-85055r1"></a><span 
class="aett-12">&#x003E;</span><span 
class="aett-12">&#x00A0;detach(airquality)</span></div>
<!--l. 296--><p class="indent" >   So it seems the two variables are correlated and have a monotonic relationship
that implies that as wind increases the amount of ozone decreases and that this
relationship is fairly linear. We will look at this relationship again when we look at
linear regression in Chapter&#x00A0;<a 
href="LURNch12.html#x14-8800012">12<!--tex4ht:ref: Regression --></a>.
                                                                          

                                                                          
<!--l. 302--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">11.6   </span> <a 
 id="x13-8600011.6"></a>Testing the independence of two categorical variables</h3>
<!--l. 304--><p class="noindent" >using the chisq.test command. Refer graphical representation to the <a 
 id="dx13-86001"></a><span 
class="aeti-12">vcd</span>
package.
<!--l. 307--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">11.7   </span> <a 
 id="x13-8700011.7"></a>Testing the normality of a distribution</h3>
<!--l. 312--><p class="noindent" >norm test package here.
<!--l. 314--><p class="indent" >   We can use the <a 
 id="dx13-87001"></a><span 
class="aett-12">ks.test() </span>function for the Kolmogorov-Smirnov test. It is
suitable for comparing two samples, or a single sample against a theoretical
distribution, or the <a 
 id="dx13-87002"></a><span 
class="aett-12">shapiro.test() </span>function which is specifically for testing for
normality.
                                                                          

                                                                          
   <!--l. 6--><div class="crosslinks"><p class="noindent">[<a 
href="../LURNblind/LURNBlindch11.html">Version for blind users</a>] [<a 

href="LURNch12.html" >next</a>] [<a 
href="LURNch10.html" >prev</a>] [<a 
href="LURNch10.html#tailLURNch10.html" >prev-tail</a>] [<a 
href="LURNch11.html" >front</a>] [<a 
href="LURN.html#LURNch11.html" >up</a>] </p></div>
<!--l. 6--><p class="indent" >   <a 
 id="tailLURNch11.html"></a>   
</body></html> 
